{"version":3,"sources":["modules/select.js"],"names":["angular","trigger","provider","container","this","defaults","keyboard","html","delay","multiple","allNoneButtons","autoClose","search","sort","caretHtml","placeholder","allText","noneText","maxLength","maxLengthHtml","iconCheckmark","toggle","$get","isNative","isTouch","SelectFactory","$select","options","scope","$scope","$activeIndex","config","$tooltip","element","$isMultiple","$showAllNoneButtons","$showSearch","$iconCheckmark","$noneText","$changeSearchText","preventDefault","stopPropagation","$close","$$postDigest","evt","$searchTextChange","$activate","index","select","activate","$isActive","$isVisible","i","$selectNone","$matches","length","matches","$updateActiveIndex","splice","a","indexOf","push","b","$apply","controller","$setViewValue","value","map","$emit","prefixEvent","onSelect","hide","isArray","$modelValue","$getIndex","minLength","$viewValue","equals","$onMouseDown","target","getAttribute","anchor","nodeName","anchorCandidate","searchText","targetEl","parent","triggerHandler","$onKeyDown","test","keyCode","$digest","isUndefined","$selectScrollFix","$isIE","stopImmediatePropagation","focus","ua","_show","show","activeElement","tagName","e","$element","addClass","$timeout","_hide","on","off","directive","$window","document","link","require","restrict","forEach","attr","falseValueRegExp","isDefined","key","$eval","bsKey","dataMultiple","slice","dataSearch","toLowerCase","inputEl","after","css","addEventListener","watchedOptions","parsedOptions","valuesFn","update","values","ngModel","$match","newValue","oldValue","console","warn","$render","selected","filter","join","label","$isEmpty","$on","collection","output","item","keyname"],"mappings":"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","file":"modules/select.min.js","sourcesContent":["'use strict';\n\nangular.module('mgcrea.ngStrap.select', ['mgcrea.ngStrap.tooltip', 'mgcrea.ngStrap.helpers.parseOptions'])\n\n  .provider('$select', function () {\n\n    var defaults = this.defaults = {\n      animation: 'am-fade',\n      prefixClass: 'select',\n      prefixEvent: '$select',\n      placement: 'bottom-left',\n      templateUrl: 'select/select.tpl.html',\n      trigger: 'focus',\n      container: false,\n      keyboard: true,\n      html: false,\n      delay: 0,\n      multiple: false,\n      allNoneButtons: false,\n      autoClose: false,\n      search: false,\n      sort: true,\n      caretHtml: '&nbsp;<span class=\"select-arrow\"><i class=\"nox-sort-down\"></i></span>',\n      placeholder: 'Choose among the following...',\n      allText: 'All',\n      noneText: 'None',\n      maxLength: 3,\n      maxLengthHtml: 'selected',\n      iconCheckmark: 'glyphicon glyphicon-ok',\n      toggle: false\n    };\n\n    this.$get = function ($window, $document, $rootScope, $tooltip, $timeout) {\n\n      // var bodyEl = angular.element($window.document.body);\n      var isNative = /(ip[ao]d|iphone|android)/ig.test($window.navigator.userAgent);\n      var isTouch = ('createTouch' in $window.document) && isNative;\n\n      function SelectFactory (element, controller, config) {\n\n        var $select = {};\n\n        // Common vars\n        var options = angular.extend({}, defaults, config);\n\n        $select = $tooltip(element, options);\n        var scope = $select.$scope;\n\n        scope.$matches = [];\n        if (options.multiple) {\n          scope.$activeIndex = [];\n        } else {\n          scope.$activeIndex = -1;\n        }\n        scope.$isMultiple = options.multiple;\n        scope.$showAllNoneButtons = options.allNoneButtons && options.multiple;\n        scope.$showSearch = options.search; // 单选复选都可以search\n        // scope.$trigger = options.search?true:false;\n        scope.$iconCheckmark = options.iconCheckmark;\n        scope.$allText = options.allText;\n        scope.$noneText = options.noneText;\n\n        scope.$searchText = '';\n\n\n        scope.$changeSearchText = function (evt) {\n          evt.preventDefault();\n          evt.stopPropagation();\n\n        };\n        scope.$close = function () {\n          scope.$$postDigest(function () {\n            $select.hide(true);\n          });\n        };\n        scope.$searchTextChange = function (evt) {\n          scope.searchText = evt.searchText;\n\n        };\n\n        scope.$activate = function (index) {\n          scope.$$postDigest(function () {\n            $select.activate(index);\n          });\n        };\n\n        scope.$select = function (index, evt) {\n          scope.$$postDigest(function () {\n            $select.select(index, evt);\n          });\n        };\n\n        scope.$isVisible = function () {\n          return $select.$isVisible();\n        };\n\n        scope.$isActive = function (index) {\n          return $select.$isActive(index);\n        };\n\n        scope.$selectAll = function () {\n          for (var i = 0; i < scope.$matches.length; i++) {\n            if (!scope.$isActive(i)) {\n              scope.$select(i);\n            }\n          }\n        };\n        scope.$selectNone = function () {\n          for (var i = 0; i < scope.$matches.length; i++) {\n            if (scope.$isActive(i)) {\n              scope.$select(i);\n            }\n          }\n        };\n\n        // Public methods\n\n        $select.update = function (matches) {\n          scope.$matches = matches;\n          $select.$updateActiveIndex();\n        };\n\n        $select.activate = function (index) {\n          if (options.multiple) {\n            if ($select.$isActive(index)) {\n              scope.$activeIndex.splice(scope.$activeIndex.indexOf(index), 1);\n            } else {\n              scope.$activeIndex.push(index);\n            }\n            if (options.sort) scope.$activeIndex.sort(function (a, b) { return a - b; }); // use numeric sort instead of default sort\n          } else {\n            scope.$activeIndex = index;\n          }\n          return scope.$activeIndex;\n        };\n\n        $select.select = function (index, evt) {\n          if (angular.isUndefined(index) || index < 0 || index >= scope.$matches.length) { return; }\n          var value = scope.$matches[index].value;\n          scope.$apply(function () {\n            $select.activate(index);\n            if (options.multiple) {\n              controller.$setViewValue(scope.$activeIndex.map(function (index) {\n                if (angular.isUndefined(scope.$matches[index])) {\n                  return null;\n                }\n                return scope.$matches[index].value;\n              }));\n            } else {\n              if (options.toggle) {\n                controller.$setViewValue((value === controller.$modelValue) ? undefined : value);\n              } else {\n                controller.$setViewValue(value);\n              }\n              // Hide if single select\n              $select.hide();\n            }\n          });\n          // Emit event\n          scope.$emit(options.prefixEvent + '.select', value, index, $select);\n          if (angular.isDefined(options.onSelect) && angular.isFunction(options.onSelect)) {\n            options.onSelect(value, index, $select);\n          }\n          // scope.searchText = '';\n        };\n\n        // Protected methods\n\n        $select.$updateActiveIndex = function () {\n          if (options.multiple) {\n            if (angular.isArray(controller.$modelValue)) {\n              scope.$activeIndex = controller.$modelValue.map(function (value) {\n                return $select.$getIndex(value);\n              });\n            } else {\n              scope.$activeIndex = [];\n            }\n          } else {\n            if (angular.isDefined(controller.$modelValue) && scope.$matches.length) {\n              scope.$activeIndex = $select.$getIndex(controller.$modelValue);\n            } else {\n              scope.$activeIndex = -1;\n            }\n          }\n        };\n\n        $select.$isVisible = function () {\n          if (!options.minLength || !controller) {\n            return scope.$matches.length;\n          }\n          // minLength support\n          return scope.$matches.length && controller.$viewValue.length >= options.minLength;\n        };\n\n        $select.$isActive = function (index) {\n          if (options.multiple) {\n            return scope.$activeIndex.indexOf(index) !== -1;\n          }\n          return scope.$activeIndex === index;\n        };\n\n        $select.$getIndex = function (value) {\n          var index;\n          for (index = scope.$matches.length; index--;) {\n            if (angular.equals(scope.$matches[index].value, value)) break;\n          }\n          return index;\n        };\n\n        $select.$onMouseDown = function (evt) {\n          // Prevent blur on mousedown on .dropdown-menu\n          // Emulate click for mobile devices\n          evt.preventDefault(true);\n          evt.stopPropagation(true);\n\n          if (evt.target.getAttribute('role') === 'search') {\n            evt.target.focus();\n            scope.searchText = '';\n          }\n          if (isTouch) {\n            var targetEl = angular.element(evt.target);\n            var anchor;\n\n            if (evt.target.nodeName !== 'A') {\n              var anchorCandidate = targetEl.parent();\n              while (!anchor && anchorCandidate.length > 0) {\n                if (anchorCandidate[0].nodeName === 'A') {\n                  anchor = anchorCandidate;\n                }\n                anchorCandidate = anchorCandidate.parent();\n              }\n            }\n\n            if (anchor) {\n              angular.element(anchor).triggerHandler('click');\n            } else {\n              targetEl.triggerHandler('click');\n            }\n          } else {\n            // console.log('no touch');\n          }\n\n\n        };\n\n        $select.$onKeyDown = function (evt) {\n          if (!/(9|13|38|40)/.test(evt.keyCode)) return;\n          // Let tab propagate\n          if (evt.keyCode !== 9) {\n            evt.preventDefault();\n            evt.stopPropagation();\n          }\n\n          // release focus on tab\n          if (options.multiple && evt.keyCode === 9) {\n            return $select.hide();\n          }\n\n          // Select with enter\n          if (!options.multiple && (evt.keyCode === 13 || evt.keyCode === 9)) {\n            return $select.select(scope.$activeIndex);\n          }\n\n          if (!options.multiple) {\n            // Navigate with keyboard\n            if (evt.keyCode === 38 && scope.$activeIndex > 0) scope.$activeIndex--;\n            else if (evt.keyCode === 38 && scope.$activeIndex < 0) scope.$activeIndex = scope.$matches.length - 1;\n            else if (evt.keyCode === 40 && scope.$activeIndex < scope.$matches.length - 1) scope.$activeIndex++;\n            else if (angular.isUndefined(scope.$activeIndex)) scope.$activeIndex = 0;\n            scope.$digest();\n          }\n        };\n\n        $select.$isIE = function () {\n          var ua = $window.navigator.userAgent;\n          return ua.indexOf('MSIE ') > 0 || ua.indexOf('Trident/') > 0 || ua.indexOf('Edge/') > 0;\n        };\n\n        $select.$selectScrollFix = function (e) {\n          if ($document[0].activeElement.tagName === 'UL') {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            e.target.focus();\n          }\n        };\n\n        // Overrides\n\n        var _show = $select.show;\n        $select.show = function () {\n          _show();\n          if (options.multiple) {\n            $select.$element.addClass('select-multiple');\n          }\n          // use timeout to hookup the events to prevent\n          // event bubbling from being processed imediately.\n          $timeout(function () {\n            $select.$element.on(isTouch ? 'touchstart' : 'mousedown', $select.$onMouseDown);\n            if (options.keyboard) {\n              element.on('keydown', $select.$onKeyDown);\n            }\n          }, 0, false);\n        };\n\n        var _hide = $select.hide;\n        $select.hide = function () {\n          if (!options.multiple && angular.isUndefined(controller.$modelValue)) {\n            scope.$activeIndex = -1;\n          }\n          if (options.search) {\n            // search 清空\n            scope.searchText = '';\n           // return;\n          }\n          $select.$element.off(isTouch ? 'touchstart' : 'mousedown', $select.$onMouseDown);\n          if (options.keyboard) {\n            element.off('keydown', $select.$onKeyDown);\n          }\n          _hide(true);\n        };\n\n        return $select;\n\n      }\n\n      SelectFactory.defaults = defaults;\n      return SelectFactory;\n\n    };\n\n  })\n\n  .directive('bsSelect', function ($window, $parse, $q, $select, $parseOptions) {\n\n    var defaults = $select.defaults;\n\n    return {\n      restrict: 'EAC',\n      require: 'ngModel',\n      link: function postLink (scope, element, attr, controller) {\n\n        // Directive options\n        var options = {scope: scope, placeholder: defaults.placeholder};\n        angular.forEach(['template', 'templateUrl', 'controller', 'controllerAs', 'placement', 'container', 'delay', 'trigger', 'keyboard', 'html', 'animation', 'placeholder', 'allNoneButtons', 'maxLength', 'maxLengthHtml', 'allText', 'noneText', 'iconCheckmark', 'autoClose', 'id',\n          'sort', 'search', 'caretHtml', 'prefixClass', 'prefixEvent', 'toggle'], function (key) {\n          if (angular.isDefined(attr[key])) options[key] = attr[key];\n        });\n\n        // use string regex match boolean attr falsy values, leave truthy values be\n        var falseValueRegExp = /^(false|0|)$/i;\n        angular.forEach(['html', 'container', 'allNoneButtons', 'sort', 'search'], function (key) {\n          if (angular.isDefined(attr[key]) && falseValueRegExp.test(attr[key])) {\n            options[key] = false;\n          }\n        });\n\n        // bind functions from the attrs to the show, hide and select events\n        angular.forEach(['onBeforeShow', 'onShow', 'onBeforeHide', 'onHide', 'onSelect'], function (key) {\n          var bsKey = 'bs' + key.charAt(0).toUpperCase() + key.slice(1);\n          if (angular.isDefined(attr[bsKey])) {\n            options[key] = scope.$eval(attr[bsKey]);\n          }\n        });\n\n        // Only parse data-multiple. Angular sets existence attributes to true (multiple/required/etc), they apply this\n        // to data-multiple as well for some reason, so we'll parse this ourselves and disregard multiple\n        var dataMultiple = element.attr('data-multiple');\n        if (angular.isDefined(dataMultiple)) {\n          if (falseValueRegExp.test(dataMultiple)) {\n            options.multiple = false;\n          } else {\n            options.multiple = dataMultiple;\n          }\n        }\n\n        // search\n        var dataSearch = element.attr('data-search');\n        if (angular.isDefined(dataSearch)) {\n          if (falseValueRegExp.test(dataSearch)) {\n            options.search = false;\n          } else {\n            options.search = dataSearch;\n            scope.searchText = '';\n          }\n        }\n\n        // Add support for select markup\n        if (element[0].nodeName.toLowerCase() === 'select') {\n          var inputEl = element;\n          inputEl.css('display', 'none');\n          element = angular.element('<button type=\"button\" class=\"btn btn-default\"></button>');\n          inputEl.after(element);\n        }\n\n        // Build proper bsOptions\n        var parsedOptions = $parseOptions(attr.bsOptions);\n\n        // Initialize select\n        var select = $select(element, controller, options);\n\n        if (select.$isIE()) {\n          element[0].addEventListener('blur', select.$selectScrollFix);\n        }\n\n        // Watch bsOptions values before filtering for changes\n        var watchedOptions = parsedOptions.$match[7].replace(/\\|.+/, '').trim();\n        scope.$watch(watchedOptions, function (newValue, oldValue) {\n          // console.warn('scope.$watch(%s)', watchedOptions, newValue, oldValue);\n          parsedOptions.valuesFn(scope, controller)\n          .then(function (values) {\n            select.update(values);\n            controller.$render();\n          });\n        }, true);\n\n        // Watch model for changes\n        scope.$watch(attr.ngModel, function (newValue, oldValue) {\n          console.warn('scope.$watch(%s)', attr.ngModel, newValue, oldValue);\n          select.$updateActiveIndex();\n          controller.$render();\n        }, true);\n\n        // Model rendering in view\n        controller.$render = function () {\n          console.warn('$render', element.attr('ng-model'), 'controller.$modelValue', typeof controller.$modelValue, controller.$modelValue, 'controller.$viewValue', typeof controller.$viewValue, controller.$viewValue);\n          var selected;\n          var index;\n          if (options.multiple && angular.isArray(controller.$modelValue)) {\n            selected = controller.$modelValue.map(function (value) {\n              index = select.$getIndex(value);\n              return index !== -1 ? select.$scope.$matches[index].label : false;\n            }).filter(angular.isDefined);\n            if (selected.length > (options.maxLength || defaults.maxLength)) {\n              selected = selected.length + ' ' + (options.maxLengthHtml || defaults.maxLengthHtml);\n            } else {\n              selected = selected.join(', ');\n            }\n          } else {\n            index = select.$getIndex(controller.$modelValue);\n            selected = index !== -1 ? select.$scope.$matches[index].label : false;\n          }\n          element.html((selected || options.placeholder) + (options.caretHtml || defaults.caretHtml));\n        };\n\n        if (options.multiple) {\n          controller.$isEmpty = function (value) {\n            return !value || value.length === 0;\n          };\n        }\n\n        // Garbage collection\n        scope.$on('$destroy', function () {\n          if (select) select.destroy();\n          options = null;\n          select = null;\n        });\n\n      }\n    };\n\n  })\n  .filter('searchFilter', function () {\n    return function (collection, keyname, value) {\n      var output = [];\n      angular.forEach(collection, function (item) {\n        // 过滤数组中值与指定值相同的元素\n        if (item[keyname].indexOf(value) > -1) {\n          output.push(item);\n        }\n      });\n      return output;\n    };\n  });\n"],"sourceRoot":"/source/"}