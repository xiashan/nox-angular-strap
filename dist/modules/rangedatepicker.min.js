/**
 * angular-strap
 * @version v2.3.10 - 2017-06-27
 * @link http://mgcrea.github.io/angular-strap
 * @author Olivier Louvignes <olivier@mg-crea.com> (https://github.com/mgcrea)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
'use strict';angular.module('mgcrea.ngStrap.rangedatepicker',['mgcrea.ngStrap.helpers.dateParser','mgcrea.ngStrap.helpers.dateFormatter','mgcrea.ngStrap.tooltip']).provider('$rangedatepicker',function(){var e=this.defaults={animation:'am-fade',prefixClass:'rangedatepicker',placement:'bottom-left',templateUrl:'rangedatepicker/rangedatepicker.tpl.html',trigger:'click',container:!1,keyboard:!0,html:!1,delay:0,useNative:!1,connector:' / ',dateType:'date',dateFormat:'yyyy-MM-dd',timezone:null,modelDateFormat:null,dayFormat:'dd',monthFormat:'MMM',yearFormat:'yyyy',monthTitleFormat:'MMMM yyyy',yearTitleFormat:'yyyy',strictFormat:!1,autoclose:!1,minDate:-(1/0),maxDate:+(1/0),minView:0,startWeek:0,daysOfWeekDisabled:'',iconLeft:'nox-sort-left',iconRight:'nox-sort-right',compare:!0};this.$get=['$window','$document','$rootScope','$sce','$dateFormatter','rangedatepickerViews','$tooltip','$timeout',function(t,a,r,n,o,i,l,u){function d(t,a,r){function n(e){e.selected=d.$isSelected(e.date)}function o(){t[0].focus()}var d=l(t,angular.extend({},e,r)),g=d.$options,m=d.$scope,D=i(d);d.$view=D.view;var p=D.viewDate;m.$iconLeft=g.iconLeft,m.$iconRight=g.iconRight,m.$compare=g.compare;var $=d.$view,f=new Date,h=d.$today=new Date(f.getFullYear(),f.getMonth(),f.getDate()),y=f.getDay();m.rangeList=[{name:'Today',value:'0d',date:{start:h,end:h}},{name:'Yesterday',value:'-2d',date:{start:new Date(h.getFullYear(),h.getMonth(),h.getDate()-1),end:new Date(h.getFullYear(),h.getMonth(),h.getDate()-1)}},{name:'Last 7 Days',value:'-7d',date:{start:new Date(h.getFullYear(),h.getMonth(),h.getDate()-6),end:h}},{name:'Last Week',value:'-1w',date:{start:new Date(h.getFullYear(),h.getMonth(),h.getDate()-6-y),end:new Date(h.getFullYear(),h.getMonth(),h.getDate()-y)}},{name:'This Month',value:'0m',date:{start:new Date(h.getFullYear(),h.getMonth(),1),end:h}},{name:'Last Month',value:'-1m',date:{start:new Date(h.getFullYear(),h.getMonth()-1,1),end:new Date(h.getFullYear(),h.getMonth(),0)}}],m.ctrl={rangeType:'',compare:''},m.$select=function(e,t){m.ctrl.compare&&t||d.select(e,t)},m.$selectPane=function(e,t){m.ctrl.compare&&t||d.$selectPane(e,t)},m.$selectRange=function(e){e===m.ctrl.rangeType||m.ctrl.compare||(d.$selectRange(e),d.hide(!0))},m.$toggleCompare=function(){var e=a.$modelValue?angular.copy(a.$modelValue):{};e.compare=m.ctrl.compare,e.onlyCompare=!0,a.$setViewValue(e),a.$render()},m.$closePicker=function(){d.hide()},m.$stopPropagation=function(e){e.stopPropagation()},d.update=function(e,t,a){angular.isDate(e)&&!isNaN(e.getTime())&&angular.isDate(t)&&!isNaN(t.getTime())&&(m.ctrl.compare?d.$compareDate=[e,t]:d.$date=[e,t],$.update.call($,e,t)),d.$build(!a)},d.updateDisabledDates=function(e){g.disabledDateRanges=e;for(var t=0,a=m.rows.length;a>t;t++)angular.forEach(m.rows[t],d.$setDisabledEl)},d.select=function(e,t,r){var n=a.$modelValue?angular.copy(a.$modelValue):{};if(n.compare=m.ctrl.compare,m.ctrl.compare?(a.$compareDateValue=a.$compareDateValue?a.$compareDateValue:[],angular.isDate(e)?(!angular.isDate(a.$compareDateValue[t])||isNaN(a.$compareDateValue[t].getTime()))&&(a.$compareDateValue[t]=new Date(e)):a.$compareDateValue[t]=null,0===t?n.compareStartDate=angular.copy(e):n.compareEndDate=angular.copy(e)):(angular.isDate(e)?(!angular.isDate(a.$dateValue[t])||isNaN(a.$dateValue[t].getTime()))&&(a.$dateValue[t]=new Date(e)):a.$dateValue[t]=null,0===t?n.startDate=angular.copy(e):n.endDate=angular.copy(e)),n.onlyCompare=!1,a.$setViewValue(n),a.$render(),!m.ctrl.compare){var o=!1;m.rangeList.forEach(function(e){e.date.start.toDateString()===n.startDate.toDateString()&&e.date.end.toDateString()===n.endDate.toDateString()&&(m.ctrl.rangeType=e.value,o=!0)}),o||(m.ctrl.rangeType='')}g.autoclose&&!r&&u(function(){d.hide(!0)})},d.$getCompare=function(){return m.ctrl&&m.ctrl.compare},d.$build=function(e){e===!0&&$.built||(e!==!1||$.built)&&$.build.call($,d.$date)},d.$updateSelected=function(){for(var e=0,t=m.rows.length;t>e;e++)angular.forEach(m.rows[e],n)},d.$isSelected=function(e){return $.isSelected(e)},d.$setDisabledEl=function(e){e.disabled=$.isDisabled(e.date)},d.$selectPane=function(e,t){var a=$.steps,r=0===t?'startDate':'endDate',n=new Date(Date.UTC(p[r].year+(a.year||0)*e,p[r].month+(a.month||0)*e,1));angular.extend(p[r],{year:n.getUTCFullYear(),month:n.getUTCMonth(),date:n.getUTCDate()}),d.$build()},d.$selectRange=function(e){var t,r=e.substr(-1),n=parseInt(e.substr(0,e.length-1),10),o=d.$today;switch(r){case'd':0>n?(t=new Date(o.getFullYear(),o.getMonth(),o.getDate()+n+1),-2===n&&(o=t)):(t=o,o=new Date(o.getFullYear(),o.getMonth(),o.getDate()+n));break;case'w':var i=o.getDay();0>=n?(t=new Date(o.getFullYear(),o.getMonth(),o.getDate()+7*n+(-1*i+1)),o=new Date(o.getFullYear(),o.getMonth(),o.getDate()+-1*i)):(t=new Date(o.getFullYear(),o.getMonth(),o.getDate()+7-i+1),o=new Date(o.getFullYear(),o.getMonth(),o.getDate()+7*n+(7-i)));break;case'm':0===n?t=new Date(o.getFullYear(),o.getMonth(),1):0>n?(t=new Date(o.getFullYear(),o.getMonth()+n,1),o=new Date(o.getFullYear(),o.getMonth(),0)):(t=new Date(o.getFullYear(),o.getMonth()+1,1),o=new Date(o.getFullYear(),o.getMonth()+n+1,0))}if(angular.isDate(t)&&angular.isDate(o)){a.$dateValue[0]=new Date(t),a.$dateValue[1]=new Date(o);var l=a.$modelValue?angular.copy(a.$modelValue):{};l.startDate=angular.copy(t),l.endDate=angular.copy(o),l.onlyCompare=!1,a.$setViewValue(l),a.$render(),m.ctrl.rangeType=e}},d.$onMouseDown=function(e){e.preventDefault(!0),e.stopPropagation(!0);var t=angular.element(e.target);c&&('button'!==t[0].nodeName.toLowerCase()&&(t=t.parent()),t.triggerHandler('click'))};var w=d.init;d.init=function(){return s&&g.useNative?(t.prop('type','date'),void t.css('-webkit-appearance','textfield')):(c&&(t.prop('type','text'),t.attr('readonly','true'),t.on('click',o)),void w())};var v=d.destroy;d.destroy=function(){s&&g.useNative&&t.off('click',o),v()};var V=d.show;d.show=function(){t.attr('disabled')||(V(),u(function(){d.$isShown&&d.$element.on(c?'touchstart':'mousedown',d.$onMouseDown)},0,!1))};var F=d.hide;return d.hide=function(e){d.$isShown&&(d.$element.off(c?'touchstart':'mousedown',d.$onMouseDown),F(e))},d}var s=/(ip[ao]d|iphone|android)/gi.test(t.navigator.userAgent),c='createTouch'in t.document&&s;return e.lang||(e.lang=o.getDefaultLocale()),d.defaults=e,d}]}).directive('bsRangedatepicker',['$window','$parse','$q','$dateFormatter','$dateParser','$rangedatepicker',function(e,t,a,r,n,o){var i=/(ip[ao]d|iphone|android)/gi.test(e.navigator.userAgent);return{restrict:'EAC',require:'ngModel',link:function(e,t,a,l){function u(e){var t;return t=angular.isDate(e)?e:'string'===c.dateType?$.parse(e,null,c.modelDateFormat):'unix'===c.dateType?new Date(1e3*e):new Date(e)}function d(e,t){if(!angular.isDate(e)||!angular.isDate(t))return!1;var a=isNaN(m.$options.minDate)||e.getTime()>=m.$options.minDate,r=isNaN(m.$options.maxDate)||t.getTime()<=m.$options.maxDate,n=a&&r;l.$setValidity('date',n),l.$setValidity('min',a),l.$setValidity('max',r);var o=m.$getCompare();return n&&(o?(l.$compareDateValue[0]=e,l.$compareDateValue[1]=t):(l.$dateValue[0]=e,l.$dateValue[1]=t)),!0}function s(){if(!l.$modelValue||!l.$modelValue.startDate||isNaN(l.$modelValue.startDate.getTime()))return'';var e=p(l.$modelValue.startDate,c.dateFormat);return l.$modelValue.compare&&l.$modelValue.compareStartDate&&!isNaN(l.$modelValue.compareStartDate.getTime())?e+=' vs '+p(l.$modelValue.compareStartDate,c.dateFormat):l.$modelValue.compare||!l.$modelValue.endDate||isNaN(l.$modelValue.endDate.getTime())||(e+=' / '+p(l.$modelValue.endDate,c.dateFormat)),e}var c={scope:e};angular.forEach(['template','templateUrl','controller','controllerAs','placement','container','delay','trigger','html','animation','autoclose','dateType','connector','dateFormat','timezone','modelDateFormat','dayFormat','strictFormat','startWeek','startDate','useNative','lang','minView','iconLeft','iconRight','daysOfWeekDisabled','id','prefixClass','prefixEvent','compare'],function(e){angular.isDefined(a[e])&&(c[e]=a[e])});var g=/^(false|0|)$/i;angular.forEach(['html','container','autoclose','useNative','compare'],function(e){angular.isDefined(a[e])&&g.test(a[e])&&(c[e]=!1)}),angular.forEach(['onBeforeShow','onShow','onBeforeHide','onHide'],function(t){var r='bs'+t.charAt(0).toUpperCase()+t.slice(1);angular.isDefined(a[r])&&(c[t]=e.$eval(a[r]))});var m=o(t,l,c);c=m.$options,i&&c.useNative&&(c.dateFormat='yyyy-MM-dd');var D=c.lang,p=function(e,t){return r.formatDate(e,t,D)},$=n({format:c.dateFormat,lang:D,strict:c.strictFormat});angular.forEach(['minDate','maxDate'],function(e){angular.isDefined(a[e])&&a.$observe(e,function(t){m.$options[e]=$.getDateForAttribute(e,t),isNaN(m.$options[e])||m.$build(!1),l.$dateValue&&d(l.$dateValue[0],l.$dateValue[1])})}),angular.isDefined(a.dateFormat)&&a.$observe('dateFormat',function(e){m.$options.dateFormat=e}),e.$watch(a.ngModel,function(e,t){e&&e.onlyCompare?m.update(null,null,!0):m.$getCompare()?m.update(l.$compareDateValue[0],l.$compareDateValue[1]):m.update(l.$dateValue[0],l.$dateValue[1])},!0),l.$parsers.unshift(function(e){var t=m.$getCompare();if(!e)return l.$setValidity('date',!0),null;if(e.onlyCompare)return e.compare=t,e;var a,r;if(t?(a=$.parse(e.compareStartDate,l.$compareDateValue[0]),r=$.parse(e.compareEndDate,l.$compareDateValue[1])):(a=$.parse(e.startDate,l.$dateValue[0]),r=$.parse(e.endDate,l.$dateValue[1])),a&&!r&&(r=angular.copy(a)),!a&&r&&(a=angular.copy(r)),!a||isNaN(a.getTime())||!r||isNaN(r.getTime()))return l.$setValidity('date',!1),!1;d(a,r);var n={dateRange:e.dateRange,compare:t},o='',i='';if(t?(n.startDate=e.startDate,n.endDate=e.endDate,o='compareStartDate',i='compareEndDate'):(o='startDate',i='endDate'),'string'===c.dateType)return n[o]=p($.timezoneOffsetAdjust(a,c.timezone,!0),c.modelDateFormat||c.dateFormat),n[i]=p($.timezoneOffsetAdjust(r,c.timezone,!0),c.modelDateFormat||c.dateFormat),n;var u,s;return t?(u=$.timezoneOffsetAdjust(l.$compareDateValue[0],c.timezone,!0),s=$.timezoneOffsetAdjust(l.$compareDateValue[1],c.timezone,!0)):(u=$.timezoneOffsetAdjust(l.$dateValue[0],c.timezone,!0),s=$.timezoneOffsetAdjust(l.$dateValue[1],c.timezone,!0)),'number'===c.dateType?(n[o]=u.getTime(),n[i]=s.getTime()):'unix'===c.dateType?(n[o]=u.getTime()/1e3,n[i]=s.getTime()/1e3):'iso'===c.dateType?(n[o]=u.toISOString(),n[i]=s.toISOString()):(n[o]=new Date(u),n[i]=new Date(s)),n}),l.$formatters.push(function(e){var t,a;return angular.isUndefined(e)||null===e?'':(e.startDate&&e.endDate?(t=u(e.startDate),a=u(e.endDate),l.$dateValue=[$.timezoneOffsetAdjust(t,c.timezone),$.timezoneOffsetAdjust(a,c.timezone)]):e.dateRange&&(l.$dateRange=e.dateRange,l.$dateValue=l.$dateValue?l.$dateValue:[],m.$selectRange(l.$dateRange)),l.$compareDateValue=[],s())}),l.$render=function(){t.val(s())},e.$on('$destroy',function(){m&&m.destroy(),c=null,m=null})}}}]).provider('rangedatepickerViews',function(){function e(e,t){for(var a=[];e.length>0;)a.push(e.splice(0,t));return a}function t(e,t){return(e%t+t)%t}this.$get=['$dateFormatter','$dateParser','$sce',function(a,r,n){return function(o){var i=o.$scope,l=o.$options,u=l.lang,d=function(e,t){return a.formatDate(e,t,u)},s=r({format:l.dateFormat,lang:u,strict:l.strictFormat}),c=a.weekdaysShort(u),g=c.slice(l.startWeek).concat(c.slice(0,l.startWeek)),m=n.trustAsHtml('<th class="dow text-center">'+g.join('</th><th class="dow text-center">')+'</th>'),D=o.$date&&o.$date[0]||(l.startDate?s.getDateForAttribute('startDate',l.startDate):new Date),p=o.$date&&o.$date[1]||(l.endDate?s.getDateForAttribute('endDate',l.endDate):new Date),$={startDate:{year:D.getFullYear(),month:D.getMonth(),date:D.getDate()},endDate:{year:p.getFullYear(),month:p.getMonth(),date:p.getDate()}},f={format:l.dayFormat,split:7,steps:{month:1},update:function(e,t,a){$.startDate={year:e.getFullYear(),month:e.getMonth(),date:e.getDate()},$.endDate={year:t.getFullYear(),month:t.getMonth(),date:t.getDate()},o.$build()},build:function(){var a=this;i.title=[],i.rows=[],['startDate','endDate'].forEach(function(r,n){var u=$[r],c=new Date(u.year,u.month,1),g=c.getTimezoneOffset(),m=new Date(+c-864e5*t(c.getDay()-l.startWeek,7)),D=m.getTimezoneOffset(),p=s.timezoneOffsetAdjust(new Date,l.timezone).toDateString();D!==g&&(m=new Date(+m+6e4*(D-g)));for(var f,h=[],y=0;42>y;y++)f=s.daylightSavingAdjust(new Date(m.getFullYear(),m.getMonth(),m.getDate()+y)),h.push({date:f,isToday:f.toDateString()===p,label:d(f,a.format),selected:o.$date&&o.$date[n]&&(!o.$getCompare()||o.$getCompare()&&!n)&&a.isSelected(o.$date[n],f),inRange:a.isInRange(f),muted:f.getMonth()!==u.month,disabled:1===n&&i.ctrl.compare||a.isDisabled(f,n),compareSelect:0===n&&i.ctrl.compare&&o.$compareDate&&o.$compareDate[n]&&a.isSelected(o.$compareDate[n],f)});i.title[n]=d(c,l.monthTitleFormat),i.rows[n]=e(h,a.split)}),i.showLabels=!0,i.labels=m,i.isTodayDisabled=this.isDisabled(new Date),this.built=!0},isSelected:function(e,t){return e&&t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()},isInRange:function(e){if(!o.$date||o.$getCompare())return!1;var t=o.$date[0],a=o.$date[1];return angular.isDate(t)&&angular.isDate(a)&&angular.isDate(e)?e.getTime()>=t.getTime()&&e.getTime()<=a.getTime():!1},isDisabled:function(e,t){var a=e.getTime();if(a<Date.parse(l.minDate)||a>Date.parse(l.maxDate))return!0;if(!i.ctrl.compare&&o.$date&&(t&&a<o.$date[t-1]||a>o.$date[t+1]))return!0;if(-1!==l.daysOfWeekDisabled.indexOf(e.getDay()))return!0;if(l.disabledDateRanges)for(var r=0;r<l.disabledDateRanges.length;r++)if(a>=l.disabledDateRanges[r].start&&a<=l.disabledDateRanges[r].end)return!0;return!1}};return{view:f,viewDate:$}}}]});
//# sourceMappingURL=rangedatepicker.min.js.map
